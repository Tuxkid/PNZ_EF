  Listing of: glean.subset
  Located in: /home/hrapgc/Rstuff/lisa/ethylformat/PNZ
Last updated: 26/11/2015 
**************************************

glean.subset <-
structure(function(x, k = 1)
{
### Purpose:- Subsets data gathered by a glean function
### ----------------------------------------------------------------------
### Modified from:- x: glean function
###                 k: id/s required --  NULL for all of them
### ----------------------------------------------------------------------
### Arguments:- 
### ----------------------------------------------------------------------
### Author:-   Patrick Connolly, Date:-  1 Oct 2015, 09:27
### ----------------------------------------------------------------------
### Revisions:-

  xx <- x()
  xx.df <- with(xx, data.frame(id, times, dead, total))
  id.tab <- table(xx$id)
  if(is.null(k))
    k <- unique(xx$id) # i.e. all of them
  xx.df$legend <- rep(xx$legend, id.tab)
  xx.df[xx.df$id %in% k,]  
}, comment = "26/11/2015")
